{% extends "base.html" %}

{% block title %}åœ¨çº¿Pythonè¿è¡Œå™¨ - Pythonå­¦ä¹ ç½‘{% endblock %}

{% block content %}
<div class="container">
    <nav class="breadcrumb">
        <a href="{{ url_for('tools') }}">å·¥å…·</a> / åœ¨çº¿Pythonè¿è¡Œå™¨
    </nav>
    
    <div class="tool-content">
        <h1>åœ¨çº¿Pythonè¿è¡Œå™¨</h1>
        <p class="subtitle">ç›´æ¥åœ¨æµè§ˆå™¨ä¸­ç¼–å†™å’Œè¿è¡ŒPythonä»£ç </p>
        
        <div class="online-editor">
            <div class="editor-container">
                <div class="editor-header">
                    <span>Pythonä»£ç ç¼–è¾‘å™¨</span>
                    <div class="editor-actions">
                        <button class="btn btn-small" id="format-code">
                            <i class="fas fa-indent"></i> æ ¼å¼åŒ–
                        </button>
                        <button class="btn btn-small btn-primary" id="run-code">
                            <i class="fas fa-play"></i> è¿è¡Œä»£ç 
                        </button>
                        <button class="btn btn-small" id="clear-code">
                            <i class="fas fa-trash"></i> æ¸…ç©º
                        </button>
                        <button class="btn btn-small" id="save-code">
                            <i class="fas fa-save"></i> ä¿å­˜
                        </button>
                    </div>
                </div>
                <textarea id="python-code" class="code-editor" placeholder="åœ¨è¿™é‡Œè¾“å…¥ä½ çš„Pythonä»£ç ..." rows="15"># æ¬¢è¿ä½¿ç”¨åœ¨çº¿Pythonè¿è¡Œå™¨ï¼
# åœ¨è¿™é‡Œç¼–å†™ä½ çš„Pythonä»£ç ï¼Œç„¶åç‚¹å‡»"è¿è¡Œä»£ç "æŒ‰é’®

print("Hello, Pythonå­¦ä¹ è€…ï¼")
print("=" * 40)

# ç¤ºä¾‹ï¼šè®¡ç®—æ–æ³¢é‚£å¥‘æ•°åˆ—
def fibonacci(n):
    """è®¡ç®—æ–æ³¢é‚£å¥‘æ•°åˆ—çš„ç¬¬né¡¹"""
    if n <= 0:
        return 0
    elif n == 1:
        return 1
    else:
        a, b = 0, 1
        for _ in range(2, n + 1):
            a, b = b, a + b
        return b

print("æ–æ³¢é‚£å¥‘æ•°åˆ—å‰15é¡¹ï¼š")
for i in range(1, 16):
    print(f"F({i:2d}) = {fibonacci(i):4d}")

print("=" * 40)
print("å°è¯•ä¿®æ”¹ä¸Šé¢çš„ä»£ç ï¼Œç„¶åè¿è¡Œçœ‹çœ‹æ•ˆæœï¼")</textarea>
                
                <div class="editor-controls">
                    <div class="control-group">
                        <label for="timeout">æ‰§è¡Œè¶…æ—¶ï¼ˆç§’ï¼‰:</label>
                        <select id="timeout">
                            <option value="2">2ç§’</option>
                            <option value="5" selected>5ç§’</option>
                            <option value="10">10ç§’</option>
                            <option value="30">30ç§’</option>
                        </select>
                    </div>
                    
                    <div class="control-group">
                        <label for="theme">ç¼–è¾‘å™¨ä¸»é¢˜:</label>
                        <select id="theme">
                            <option value="light" selected>æ˜äº®</option>
                            <option value="dark">æš—é»‘</option>
                        </select>
                    </div>
                </div>
                
                <div class="editor-output" id="code-output">
                    <div class="output-header">
                        <span>è¿è¡Œç»“æœ</span>
                        <div class="output-actions">
                            <button class="btn btn-small" id="copy-output">
                                <i class="fas fa-copy"></i> å¤åˆ¶ç»“æœ
                            </button>
                            <button class="btn btn-small" id="clear-output">
                                <i class="fas fa-times"></i> æ¸…ç©ºç»“æœ
                            </button>
                        </div>
                    </div>
                    <div class="output-content" id="output-content">
                        <!-- è¿è¡Œç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ -->
                        <div class="welcome-message">
                            <p>ğŸ‘‹ æ¬¢è¿ä½¿ç”¨åœ¨çº¿Pythonè¿è¡Œå™¨ï¼</p>
                            <p>åœ¨è¿™é‡Œä½ å¯ä»¥ï¼š</p>
                            <ul>
                                <li>ç¼–å†™å’Œè¿è¡ŒPythonä»£ç </li>
                                <li>æµ‹è¯•ä»£ç ç‰‡æ®µ</li>
                                <li>å­¦ä¹ Pythonè¯­æ³•</li>
                                <li>è°ƒè¯•ç¨‹åº</li>
                            </ul>
                            <p>ç‚¹å‡»"è¿è¡Œä»£ç "æŒ‰é’®å¼€å§‹ï¼</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="feature-cards">
            <div class="feature-card">
                <i class="fas fa-shield-alt"></i>
                <h3>å®‰å…¨è¿è¡Œ</h3>
                <p>ä»£ç åœ¨å®‰å…¨çš„æ²™ç®±ç¯å¢ƒä¸­æ‰§è¡Œï¼Œä¸ä¼šå½±å“æœåŠ¡å™¨</p>
            </div>
            <div class="feature-card">
                <i class="fas fa-bolt"></i>
                <h3>å¿«é€Ÿå“åº”</h3>
                <p>ä»£ç æ‰§è¡Œå¿«é€Ÿï¼Œæ”¯æŒ5ç§’è¶…æ—¶ä¿æŠ¤</p>
            </div>
            <div class="feature-card">
                <i class="fas fa-code"></i>
                <h3>å®æ—¶åé¦ˆ</h3>
                <p>ç«‹å³çœ‹åˆ°ä»£ç æ‰§è¡Œç»“æœå’Œé”™è¯¯ä¿¡æ¯</p>
            </div>
        </div>
        
        <div class="code-examples">
            <h3>ä»£ç ç¤ºä¾‹</h3>
            <div class="examples-grid">
                <div class="example-card">
                    <h4>åŸºæœ¬è¾“å…¥è¾“å‡º</h4>
                    <pre><code>name = input("è¯·è¾“å…¥ä½ çš„åå­—: ")
print(f"ä½ å¥½, {name}!")
age = int(input("è¯·è¾“å…¥ä½ çš„å¹´é¾„: "))
print(f"æ˜å¹´ä½ å°±{age + 1}å²äº†")</code></pre>
                    <button class="btn btn-small load-example" data-code="name = input(&quot;è¯·è¾“å…¥ä½ çš„åå­—: &quot;)&#10;print(f&quot;ä½ å¥½, {name}!&quot;)&#10;age = int(input(&quot;è¯·è¾“å…¥ä½ çš„å¹´é¾„: &quot;))&#10;print(f&quot;æ˜å¹´ä½ å°±{age + 1}å²äº†&quot;)">
                        åŠ è½½ç¤ºä¾‹
                    </button>
                </div>
                <div class="example-card">
                    <h4>åˆ—è¡¨æ“ä½œ</h4>
                    <pre><code># åˆ›å»ºåˆ—è¡¨
fruits = ['è‹¹æœ', 'é¦™è•‰', 'æ©™å­', 'è‘¡è„']
print("æ°´æœåˆ—è¡¨:", fruits)

# æ·»åŠ å…ƒç´ 
fruits.append('è¥¿ç“œ')
print("æ·»åŠ å:", fruits)

# éå†åˆ—è¡¨
for i, fruit in enumerate(fruits, 1):
    print(f"{i}. {fruit}")</code></pre>
                    <button class="btn btn-small load-example" data-code="# åˆ›å»ºåˆ—è¡¨&#10;fruits = ['è‹¹æœ', 'é¦™è•‰', 'æ©™å­', 'è‘¡è„']&#10;print(&quot;æ°´æœåˆ—è¡¨:&quot;, fruits)&#10;&#10;# æ·»åŠ å…ƒç´ &#10;fruits.append('è¥¿ç“œ')&#10;print(&quot;æ·»åŠ å:&quot;, fruits)&#10;&#10;# éå†åˆ—è¡¨&#10;for i, fruit in enumerate(fruits, 1):&#10;    print(f&quot;{i}. {fruit}&quot;)">
                        åŠ è½½ç¤ºä¾‹
                    </button>
                </div>
                <div class="example-card">
                    <h4>æ–‡ä»¶æ“ä½œ</h4>
                    <pre><code># å†™å…¥æ–‡ä»¶
with open('test.txt', 'w', encoding='utf-8') as f:
    f.write("è¿™æ˜¯æµ‹è¯•æ–‡ä»¶å†…å®¹\\n")
    f.write("ç¬¬äºŒè¡Œå†…å®¹\\n")
print("æ–‡ä»¶å†™å…¥å®Œæˆ")

# è¯»å–æ–‡ä»¶
with open('test.txt', 'r', encoding='utf-8') as f:
    content = f.read()
print("æ–‡ä»¶å†…å®¹:\\n", content)</code></pre>
                    <button class="btn btn-small load-example" data-code="# å†™å…¥æ–‡ä»¶&#10;with open('test.txt', 'w', encoding='utf-8') as f:&#10;    f.write(&quot;è¿™æ˜¯æµ‹è¯•æ–‡ä»¶å†…å®¹\\n&quot;)&#10;    f.write(&quot;ç¬¬äºŒè¡Œå†…å®¹\\n&quot;)&#10;print(&quot;æ–‡ä»¶å†™å…¥å®Œæˆ&quot;)&#10;&#10;# è¯»å–æ–‡ä»¶&#10;with open('test.txt', 'r', encoding='utf-8') as f:&#10;    content = f.read()&#10;print(&quot;æ–‡ä»¶å†…å®¹:\\n&quot;, content)">
                        åŠ è½½ç¤ºä¾‹
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const codeEditor = document.getElementById('python-code');
    const runButton = document.getElementById('run-code');
    const clearButton = document.getElementById('clear-code');
    const formatButton = document.getElementById('format-code');
    const saveButton = document.getElementById('save-code');
    const copyOutputButton = document.getElementById('copy-output');
    const clearOutputButton = document.getElementById('clear-output');
    const outputContent = document.getElementById('output-content');
    const timeoutSelect = document.getElementById('timeout');
    const themeSelect = document.getElementById('theme');
    
    // è¿è¡Œä»£ç 
    runButton.addEventListener('click', function() {
        const code = codeEditor.value;
        const timeout = parseInt(timeoutSelect.value);
        
        outputContent.innerHTML = '<div class="loading">æ­£åœ¨è¿è¡Œä»£ç ...</div>';
        
        fetch('/run_code', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ 
                code: code,
                timeout: timeout
            })
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                outputContent.innerHTML = `<pre class="success">${data.output || 'ä»£ç æ‰§è¡ŒæˆåŠŸï¼Œä½†æ²¡æœ‰è¾“å‡º'}</pre>`;
            } else {
                outputContent.innerHTML = `<pre class="error">é”™è¯¯ï¼š${data.error || 'æœªçŸ¥é”™è¯¯'}</pre>`;
            }
        })
        .catch(error => {
            outputContent.innerHTML = `<pre class="error">è¯·æ±‚å¤±è´¥ï¼š${error.message}</pre>`;
        });
    });
    
    // æ¸…ç©ºä»£ç 
    clearButton.addEventListener('click', function() {
        if (confirm('ç¡®å®šè¦æ¸…ç©ºä»£ç ç¼–è¾‘å™¨å—ï¼Ÿ')) {
            codeEditor.value = '';
            outputContent.innerHTML = '<div class="welcome-message">ä»£ç å·²æ¸…ç©º</div>';
        }
    });
    
    // æ ¼å¼åŒ–ä»£ç ï¼ˆç®€å•ç¤ºä¾‹ï¼‰
    formatButton.addEventListener('click', function() {
        let code = codeEditor.value;
        // ç®€å•çš„æ ¼å¼åŒ–ï¼šç¡®ä¿ç¼©è¿›ä¸€è‡´
        code = code.replace(/\t/g, '    '); // åˆ¶è¡¨ç¬¦è½¬4ä¸ªç©ºæ ¼
        codeEditor.value = code;
        outputContent.innerHTML = '<pre class="success">ä»£ç å·²æ ¼å¼åŒ–ï¼ˆåŸºç¡€åŠŸèƒ½ï¼‰</pre>';
    });
    
    // ä¿å­˜ä»£ç ï¼ˆæœ¬åœ°å­˜å‚¨ï¼‰
    saveButton.addEventListener('click', function() {
        const code = codeEditor.value;
        try {
            localStorage.setItem('python_runner_code', code);
            outputContent.innerHTML = '<pre class="success">ä»£ç å·²ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨</pre>';
        } catch (e) {
            outputContent.innerHTML = `<pre class="error">ä¿å­˜å¤±è´¥ï¼š${e.message}</pre>`;
        }
    });
    
    // åŠ è½½ä¿å­˜çš„ä»£ç 
    window.addEventListener('load', function() {
        const savedCode = localStorage.getItem('python_runner_code');
        if (savedCode) {
            codeEditor.value = savedCode;
        }
    });
    
    // å¤åˆ¶è¾“å‡ºç»“æœ
    copyOutputButton.addEventListener('click', function() {
        const outputText = outputContent.textContent;
        navigator.clipboard.writeText(outputText)
            .then(() => {
                alert('è¾“å‡ºç»“æœå·²å¤åˆ¶åˆ°å‰ªè´´æ¿');
            })
            .catch(err => {
                console.error('å¤åˆ¶å¤±è´¥:', err);
            });
    });
    
    // æ¸…ç©ºè¾“å‡ºç»“æœ
    clearOutputButton.addEventListener('click', function() {
        outputContent.innerHTML = '<div class="welcome-message">è¾“å‡ºå·²æ¸…ç©º</div>';
    });
    
    // åˆ‡æ¢ä¸»é¢˜
    themeSelect.addEventListener('change', function() {
        const theme = this.value;
        if (theme === 'dark') {
            codeEditor.style.backgroundColor = '#1e1e1e';
            codeEditor.style.color = '#d4d4d4';
        } else {
            codeEditor.style.backgroundColor = 'white';
            codeEditor.style.color = '#333';
        }
    });
    
    // åŠ è½½ç¤ºä¾‹ä»£ç 
    document.querySelectorAll('.load-example').forEach(button => {
        button.addEventListener('click', function() {
            const code = this.dataset.code;
            // è§£ç HTMLå®ä½“
            const decodedCode = code.replace(/&#10;/g, '\n')
                                   .replace(/&quot;/g, '"')
                                   .replace(/&#39;/g, "'");
            codeEditor.value = decodedCode;
            outputContent.innerHTML = '<div class="success">ç¤ºä¾‹ä»£ç å·²åŠ è½½ï¼Œç‚¹å‡»"è¿è¡Œä»£ç "æµ‹è¯•</div>';
        });
    });
});
</script>
{% endblock %}
